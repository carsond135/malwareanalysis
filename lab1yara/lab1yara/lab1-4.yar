include "D:/yara/yararules/lab1yara/lab1-2.yar"
rule DownloadFromInternet{
    meta:
        description="从网上下载内容"
        author="wbf"
        date="2022-10-12"
    strings:
        $a="URLDownloadToFile"
    condition:
        $a and IsPE and smallFileSize
}

rule CallNewEXE{
    meta:
        description="可能会调用新的EXE文件"
        author="wbf"
        date="2022-10-12"
    strings:
        $a="winexec" nocase
    condition:
        $a and IsPE and smallFileSize
}

rule ISMaybeKnownMalware{
    meta:
        description="包含已有病毒的名字，可能是病毒"
        author="wbf"
        date="2022-10-12"
    strings:
        $a="winup" nocase
        $b="malware" nocase
    condition:
        IsPE and ($a or $b) and smallFileSize
}

rule operatePermission{
    meta:
        description="进行与权限有关的操作"
        author="wbf"
        date="2022-10-12"
    strings:
        $a="advapi32" nocase
        $b="privilige" nocase
        $c="process" nocase
    condition:
        IsPE and ($a or ($b and $c)) and smallFileSize
}
