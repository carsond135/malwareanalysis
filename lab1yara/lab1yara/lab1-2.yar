include "D:/yara/yararules/lab1yara/lab1-1.yar"

rule UPXShelling{
    meta:
        description="UPX技术加壳"
        author="wbf"
        date="2022-10-12"
    strings:
        $a = "UPX"
    condition:
        IsPE and $a and smallFileSize
}

rule CallTheFunction{
    meta:
        description="该程序使用运行时链接，不能只看其导入表，需要分析其程序本身"
        author="wbf"
        date="2022-10-12"
    strings:
        $a="LoadLibraryA"
        $b="GetProcAddress"
    condition:
        $a and $b and IsPE and smallFileSize
}

rule VisitInternet{
    meta:
        description="该程序很有可能访问了互联网"
        author="wbf"
        date="2022-10-12"
    strings:
        $a="WININET.dll"
        $b="InternetOpenA"
        $c="http"
        $d="https"
        $e="www"
        $f="ws2_32" nocase
    condition:
        ($a or $b or $f) or ($c or $d or $e) and IsPE and smallFileSize

}